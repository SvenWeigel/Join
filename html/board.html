<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <base href="../">
  <link rel="shortcut icon" href="assets/img/login_center_logo.svg" type="image/x-icon" />
  <link rel="stylesheet" href="styles/board.css" />
  <link rel="stylesheet" href="styles/board_modal.css" />
  <link rel="stylesheet" href="styles/global.css" />
  <link rel="stylesheet" href="styles/font.css" />
  <link rel="stylesheet" href="styles/menu-bar.css" />
  <link rel="stylesheet" href="styles/header.css" />
  <link rel="stylesheet" href="styles/modal-task-view.css">
  <link rel="stylesheet" href="styles/modal-edit-view-task.css">
  <link rel="stylesheet" href="styles/bottom-nav.css">
  <link rel="stylesheet" href="styles/responsiv/responsiv_board.css">
  <link rel="stylesheet" href="styles/responsiv/responsiv_edit_view.css">
  <script src="scripts/script.js"></script>
  <script>if (typeof checkAuth === 'function' && !checkAuth()) { document.write(''); }</script>

  <title>Join</title>
</head>

<body>

  <div id="rotate-warning">
      Bitte drehe dein Ger√§t ins Hochformat
    </div>
  <div id="rotate-protection">  
  <div class="main-layout-container">
    <header>
      <div class="header-content">
        <img class="logo-responsive" src="assets/img/logo.svg">
        <span>Kanban Project Management Tool</span>
        <div class="header-profile-container">
          <a href="html/help.html"><img src="assets/icons/help.svg" alt="help_icon" /></a>
          <div class="user-badge" onclick="showProfileOptions()" title="Benutzer">
            <div class="user-avatar">SM</div>
          </div>
        </div>
        <div class="profile-options d-none" id="profile-options">
          <a class="help-options" href="html/help.html">Help</a>
          <a href="html/legal_notice.html">Legal Notice</a>
          <a href="html/privacy_policy.html">Privacy Policy</a>
          <a href="#" onclick="logout(); return false;">Log Out</a>
        </div>
      </div>
    </header>

    <aside class="menu-bar-container">
      <div class="join-logo-container">
        <img src="assets/img/join_logo_vector.svg" alt="join logo" />
      </div>

      <div class="menu-bar-btn-container">
        <div class="summary-btn center-btn">
          <a class="main-bar-btn" href="html/summary.html">
            <img src="assets/icons/summary.svg" alt="" />Summary
          </a>
        </div>
        <div class="add-task-btn center-btn">
          <a class="main-bar-btn" href="html/add_task.html">
            <img src="assets/icons/add_task.svg" alt="" />Add Task
          </a>
        </div>
        <div class="board-btn center-btn">
          <a class="main-bar-btn" href="html/board.html">
            <img src="assets/icons/board.svg" alt="" />Board
          </a>
        </div>
        <div class="contacts-btn center-btn">
          <a class="main-bar-btn" href="html/contacts.html">
            <img src="assets/icons/contacts.svg" alt="" />Contacts
          </a>
        </div>
      </div>

      <div class="legal-container">
        <div class="privacy-btn">
          <a href="html/privacy_policy.html">Privacy Policy</a>
        </div>
        <div class="legal-link">
          <a href="html/legal_notice.html">Legal Notice</a>
        </div>
      </div>
    </aside>

    <main class="board-container">
      <div class="board-header">
        <h1>Board</h1>
        <div class="find-add-container">
          <div class="search-bar">
            <input type="text" id="findTask" placeholder="Find Task" />
            <div class="find-separator"></div>
            <img src="assets/icons/search.svg">
          </div>
          <button id="addTaskBtn">
            <span class="add-task-span">Add task</span><img src="assets/icons/add.svg" />
          </button>
        </div>
      </div>
      <div class="responsive-input">
        <input type="text" id="findTask-responsive" placeholder="Find Task" />
        <div class="find-separator-responsive"></div>
        <img src="assets/icons/search.svg">
      </div>
    
      <div class="board-columns">
        <div class="column">
          <div class="column-header">
            <h2>To do</h2>
            <img src="assets/icons/plus-button.svg" />
          </div>
          <div class="column-content"></div>
        </div>
        <div class="column">
          <div class="column-header">
            <h2>In progress</h2>
            <img src="assets/icons/plus-button.svg" />
          </div>
          <div class="column-content"></div>
        </div>
        <div class="column">
          <div class="column-header">
            <h2>Await feedback</h2>
            <img src="assets/icons/plus-button.svg" />
          </div>
          <div class="column-content"></div>
        </div>
        <div class="column">
          <div class="column-header">
            <h2>Done</h2>
          </div>
          <div class="column-content"></div>
        </div>
      </div>
    </main>

    <!-- No Search Results Message -->
    <div id="noSearchResults" class="no-search-results">
      <span>No tasks found</span>
    </div>

    <!-- Mobile Move Menu -->
    <div id="moveMenuOverlay" class="move-menu-overlay" onclick="closeMoveMenu()">
      <div class="move-menu" onclick="event.stopPropagation()">
        <span class="move-menu-title">Move to</span>
        <button type="button" class="move-menu-option" data-status="todo" onclick="moveTaskToStatus('todo')">
          To do
        </button>
        <button type="button" class="move-menu-option" data-status="inprogress" onclick="moveTaskToStatus('inprogress')">
          In progress
        </button>
        <button type="button" class="move-menu-option" data-status="awaitfeedback" onclick="moveTaskToStatus('awaitfeedback')">
          Await feedback
        </button>
        <button type="button" class="move-menu-option" data-status="done" onclick="moveTaskToStatus('done')">
          Done
        </button>
      </div>
    </div>

    <nav class="bottom-nav">
      <a href="html/summary.html" class="nav-div">
        <img class="bottom-nav-img" src="../assets/icons/summary.svg">
        <span class="bottom-nav-span">Summary</span>
      </a>
      <a href="html/add_task.html" class="nav-div">
        <img class="bottom-nav-img" src="assets/icons/add_task.svg">
        <span class="bottom-nav-span">Add Task</span>
      </a>
      <a href="html/board.html" class="nav-div current-nav">
        <img class="bottom-nav-img" src="../assets/icons/board.svg">
        <span class="bottom-nav-span">Board</span>
      </a>
      <a href="html/contacts.html" class="nav-div">
        <img class="bottom-nav-img" src="assets/icons/contacts.svg">
        <span class="bottom-nav-span">Contacts</span>
      </a>
    </nav>
    <!-- Add Task Modal -->
    <div id="addTaskModalOverlay" class="modal-overlay" aria-hidden="true">
      <div class="add-task-modal" role="dialog" aria-labelledby="addTaskModalTitle">
        <button type="button" id="closeAddTaskBtn" class="modal-close" aria-label="Close">
          <svg width="14" height="14" viewBox="0 0 14 14" fill="none">
            <path d="M1 1L13 13M1 13L13 1" stroke="currentColor" stroke-width="2" stroke-linecap="round" />
          </svg>
        </button>

        <div class="modal-header">
          <h2 id="addTaskModalTitle">Add Task</h2>
        </div>

        <form id="addTaskForm">
          <div class="add-task-container">
            <!-- Linke Spalte -->
            <div class="left-content">
              <div class="title-section">
                <label for="taskTitle">Title<span class="required-star">*</span></label>
                <input id="taskTitle" name="title" class="titel-input" type="text" placeholder="Enter a title"
                  required />
              </div>
              <div class="description-section">
                <span>Description</span>
                <textarea name="description" maxlength="440" placeholder="Enter a Description"></textarea>
              </div>
              <div class="due-date-section">
                <label for="taskDueDate">Due date<span class="required-star">*</span></label>
                <input id="taskDueDate" name="due" class="due-date-input" type="date" placeholder="dd/mm/yyyy"
                  required />
              </div>
            </div>

            <!-- Trennlinie -->
            <div class="seperator-content"></div>

            <!-- Rechte Spalte -->
            <div class="right-content">
              <div class="priority-section">
                <span>Priority</span>
                <div class="priority-buttons-container">
                  <button type="button" class="priority-btn" data-priority="urgent">
                    Urgent
                    <img src="assets/icons/urgent_icon.svg" alt="Urgent" class="prio-icon" />
                  </button>
                  <button type="button" class="priority-btn active" data-priority="medium">
                    Medium
                    <img src="assets/icons/medium_icon_orange.svg" alt="Medium" class="prio-icon" />
                  </button>
                  <button type="button" class="priority-btn" data-priority="low">
                    Low
                    <img src="assets/icons/low_icon.svg" alt="Low" class="prio-icon" />
                  </button>
                </div>
              </div>

              <div class="assigned-section">
                <label>Assigned to</label>
                <div class="custom-dropdown" id="modalAssigneeDropdown">
                  <div class="dropdown-header" onclick="toggleModalAssigneeDropdown()">
                    <input type="text" id="modalAssigneeSearch" class="dropdown-search"
                      placeholder="Select contacts to assign" oninput="filterModalAssigneeList()"
                      onfocus="openModalAssigneeDropdown()" />
                    <img src="assets/icons/arrow_drop_downaa.svg" alt="Dropdown" class="dropdown-arrow" />
                  </div>
                  <div class="dropdown-list" id="modalAssigneeList"></div>
                </div>
                <div class="selected-contacts" id="modalSelectedContactsBadges"></div>
              </div>

              <div class="category-section">
                <label>Category<span class="required-star">*</span></label>
                <div class="custom-dropdown" id="modalCategoryDropdown">
                  <div class="dropdown-header" onclick="toggleModalCategoryDropdown()">
                    <span id="modalCategorySelected" class="dropdown-selected-text">Select task category</span>
                    <img src="assets/icons/arrow_drop_downaa.svg" alt="Dropdown" class="dropdown-arrow"
                      id="categoryDropdownArrow" />
                  </div>
                  <div class="dropdown-list" id="modalCategoryList">
                    <div class="dropdown-item category-option" data-value="technical"
                      onclick="selectModalCategory('technical', 'Technical Task')">
                      <span>Technical Task</span>
                    </div>
                    <div class="dropdown-item category-option" data-value="userstory"
                      onclick="selectModalCategory('userstory', 'User Story')">
                      <span>User Story</span>
                    </div>
                  </div>
                </div>
                <input type="hidden" id="taskCategory" name="category" required />
              </div>

              <div class="subtasks-section">
                <label>Subtasks</label>
                <div class="subtask-input-wrapper" id="modalSubtaskInputWrapper">
                  <input id="taskSubtasks" name="subtasks" class="subtask-input" type="text"
                    placeholder="Add new subtask" onfocus="showModalSubtaskActions()"
                    onblur="hideModalSubtaskActionsDelayed()" onkeydown="handleModalSubtaskKeydown(event)" />
                  <div class="subtask-actions" id="modalSubtaskActions">
                    <img src="assets/icons/cancel_subtask.svg" alt="Cancel" class="subtask-action-icon"
                      onclick="cancelModalSubtaskInput()" />
                    <div class="subtask-action-divider"></div>
                    <img src="assets/icons/check_subtask.svg" alt="Confirm" class="subtask-action-icon"
                      onclick="confirmModalSubtaskInput()" />
                  </div>
                </div>
                <ul class="subtask-list" id="modalSubtaskList"></ul>
              </div>
            </div>
          </div>

          <!-- Footer mit Required-Hinweis und Buttons -->
          <div class="modal-footer-wrapper">
            <span class="required-note"><span class="required-star">*</span>This field is
              required</span>
            <div class="modal-footer">
              <button type="button" id="cancelAddTask" class="btn-cancel">
                Cancel
                <img class="modal-close-icon" src="assets/icons/iconoir_cancel.svg" alt="Close" />
              </button>
              <button type="submit" class="btn-create-task">
                Create Task
                <img class="check-icon" src="assets/icons/check.svg" alt="check" />
                </svg>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <div class="modal-task-view-overlay d-none" id="modalTaskViewOverlay">
      <div class="inside-modal-view-overlay">
        <div class="task-view-header">
          <span>User Story</span>
          <button onclick="closeTaskViewModal()"><img src="assets/icons/close-icon.svg"
              alt="close-overlay-button"></button>
        </div>
        <div class="task-view-title">
          <span>Kochwelt Page & Recipe Recommender</span>
        </div>
        <div class="task-view-description">
          <span>Build start page with recipe recommendation.</span>
        </div>
        <div class="task-view-due-date">
          <span class="due-date-span">Due Date:</span>
          <span>20/09/2024</span>
        </div>
        <div class="task-view-priority">
          <span class="priority-span-task-view">Priority:</span>
          <div class="priority-view-container">
            <span class="priority-span">Medium</span>
            <img src="assets/icons/medium_icon_orange.svg" alt="Priority Medium Icon">
          </div>
        </div>
        <div class="task-view-assigned-to-container">
          <span class="assigned-to-span">Assigned to:</span>
          <div class="assigned-avatars-container-list">
            <div class="assigned-avatar contact-avatar-task-view" title="Avatar">SM</div>
            <span class="avatar-full-name" title="full Name">Sarah Miller</span>
          </div>
        </div>
        <div class="subtask-task-view">
          <span class="subtasks-span-task-view">Subtasks</span>
          <div class="subtasks-list-container">
            <div class="subtask-item">
              <input type="checkbox" id="subtask1" name="subtask1">
              <label for="subtask1">Design homepage layout</label>
            </div>
            <div class="subtask-item">
              <input type="checkbox" id="subtask2" name="subtask2" checked>
              <label for="subtask2">Implement recipe recommendation algorithm</label>
            </div>
            <div class="subtask-item">
              <input type="checkbox" id="subtask3" name="subtask3">
              <label for="subtask3">Integrate user feedback system</label>
            </div>
          </div>
        </div>
        <div class="delete-edit-btn-container">
          <button class="delete-btn-task-view" onclick="deleteCurrentTask()"><img src="assets/icons/delete.svg"
              alt="">Delete</button>
          <div class="task-view-separator-div"></div>
          <button class="edit-btn-task-view" onclick="openEditModal()"><img src="assets/icons/edit.svg"
              alt="">Edit</button>
        </div>
      </div>
    </div>

    <div class="modal-edit-view-task-overlay d-none" id="modalEditViewTaskOverlay">
      <div class="inside-edit-view-task-overlay">
        <div class="scroll-container">
          <div class="close-btn">
            <button onclick="closeEditModal()"><img src="assets/icons/close-icon.svg"
                alt="close-overlay-button"></button>
          </div>

          <div class="title-input-div">
            <h4>Title</h4>
            <input type="text" maxlength="40">
          </div>

          <div class="description-input-div">
            <h4>Description</h4>
            <textarea></textarea>
          </div>

          <div class="due-date-input-div">
            <h4>Due Date</h4>
            <input type="date">

          </div>

          <div class="priority-btn-div">
            <h4>Priority</h4>
            <div class="priority-buttons-container-edit-view">
              <button type="button" class="priority-btn-edit-view" data-priority="urgent"
                onclick="selectEditPriority('urgent')">
                Urgent
                <img src="assets/icons/urgent_icon.svg" alt="Urgent" class="prio-icon" />
              </button>
              <button type="button" class="priority-btn-edit-view" data-priority="medium"
                onclick="selectEditPriority('medium')">
                Medium
                <img src="assets/icons/medium_icon_orange.svg" alt="Medium" class="prio-icon" />
              </button>
              <button type="button" class="priority-btn-edit-view" data-priority="low"
                onclick="selectEditPriority('low')">
                Low
                <img src="assets/icons/low_icon.svg" alt="Low" class="prio-icon" />
              </button>
            </div>
            <div class="assigned-to-div">
              <h4>Assigned to</h4>

              <div class="assigned-avatars-container-edit-view" onclick="openEditViewAssigneeDropdown()">
                <input type="text" id="editViewAssigneeSearch" class="dropdown-search-edit-view"
                  placeholder="Select contacts to assign" oninput="filterEditViewAssigneeList()" />

                <img src="assets/icons/arrow_drop_downaa.svg" class="assigned-arrow" id="assignedArrow" />
              </div>

              <div class="assigned-dropdown-list" id="assignedDropdownList"></div>
              <div class="selected-assignees-badges" id="editSelectedAssigneesBadges"></div>
            </div>

            <div class="subtasks-div">
              <h4>Subtasks</h4>
              <div class="subtask-input-wrapper-edit" id="editSubtaskInputWrapper">
                <input type="text" id="editViewSubtaskInput" class="subtask-input-edit-view"
                  placeholder="Add new subtask" onfocus="showEditSubtaskActions()"
                  onblur="hideEditSubtaskActionsDelayed()" onkeydown="handleEditSubtaskKeydown(event)" />
                <div class="subtask-actions-input" id="editSubtaskActions">
                  <img src="assets/icons/cancel_subtask.svg" alt="Cancel" class="subtask-action-icon"
                    onclick="cancelEditSubtaskInput()" />
                  <div class="subtask-action-divider"></div>
                  <img src="assets/icons/check_subtask.svg" alt="Confirm" class="subtask-action-icon"
                    onclick="confirmEditSubtaskInput()" />
                </div>
              </div>
              <div class="subtasks-list-edit-view" id="subtasksListEditView"></div>
            </div>

            <div class="edit-modal-footer">
              <button type="button" class="btn-ok" onclick="saveTaskChanges()">
                Ok <img src="assets/icons/check.svg" alt="check" />
              </button>
            </div>
          </div>
        </div>

      </div>
    </div>
    </div>
    <script src="scripts/header.js"></script>
    <script src="scripts/db.js"></script>
    <script src="templates/template_board.js"></script>
    <script src="templates/template_add_task.js"></script>
    <script src="render/render_add_task.js"></script>
    <script src="render/render_board.js"></script>
    <script src="render/render_board_task.js"></script>
    <script src="render/render_board_cards.js"></script>
    <script src="scripts/drag_and_drop.js"></script>
    <script src="scripts/board_modal_assigned_to.js"></script>
    <script src="scripts/board_modal_category.js"></script>
    <script src="scripts/board_modal_subtask.js"></script>
    <script src="scripts/board_modal_add_task.js"></script>
    <script src="scripts/board_modal_cards.js"></script>
    <script src="scripts/board_modal_cards_edit.js"></script>
    <script src="scripts/board_modal_edit_subtasks.js"></script>
    <script src="scripts/script.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        renderAllTasks();
        initBoardSearch();
      });
    </script>
</body>

</html>